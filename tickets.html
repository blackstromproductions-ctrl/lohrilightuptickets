<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ðŸŽŸ Tickets - Halloween Neon Party</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .glow-text {
      background: linear-gradient(to right, #3b82f6, #ec4899);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 15px rgba(59,130,246,0.6),
                   0 0 25px rgba(236,72,153,0.5);
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">

  <!-- Header -->
<header class="p-4 border-b bg-blue-50 flex items-center justify-center space-x-3">
  <img src="logo.png" alt="Logo" class="object-contain" height="90px" width="90px"/>
  <h1 class="text-7xl font-extrabold glow-text tracking-wide">
    BLACK STROM PRODUCTIONS
  </h1>
</header>

  <section class="p-4 pt-28">
    <a href="index.html" class="text-sm text-blue-500 font-medium">&larr; Back to Event</a>
    <h2 class="text-xl font-bold mt-3 mb-4">ðŸŽŸ Select Your Tickets</h2>

    <div id="tickets" class="space-y-4"></div>

    <div class="mt-6 bg-white p-4 rounded-lg shadow text-center">
      <p class="text-lg font-semibold">Total: <span id="total-price">â‚¬0.00</span></p>
      <button id="proceedBtn" class="mt-3 bg-red-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-red-600">
        PROCEED TO PAYMENT
      </button>
    </div>
  </section>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // ticket definitions
      const ticketsData = [
        { name: "Early Bird", price: 6, max: 10 },
        { name: "Night Bird", price: 8, max: 10 },
        { name: "Sweet Couple", price: 14, max: 5 },
        { name: "Party Kings", price: 32, max: 5 }
      ];

      const container = document.getElementById("tickets");
      const totalSpan = document.getElementById("total-price");
      const proceedBtn = document.getElementById("proceedBtn");
      let total = 0;
      // will hold objects like { name, price, quantity }
      let selectedTickets = [];

      // render ticket cards
      ticketsData.forEach((ticket, idx) => {
        const div = document.createElement("div");
        div.className = "ticket-item bg-white p-4 rounded-lg shadow flex justify-between items-center";
        div.dataset.index = idx;
        div.innerHTML =
          '<div>' +
            '<h3 class="font-semibold">' + ticket.name + '</h3>' +
            '<p class="text-gray-500 text-sm">â‚¬' + ticket.price + '.00 | Max ' + ticket.max + '</p>' +
          '</div>' +
          '<div class="flex items-center space-x-2">' +
            '<button class="minus bg-gray-300 text-gray-700 px-2 rounded">-</button>' +
            '<span class="quantity text-lg font-semibold">0</span>' +
            '<button class="plus bg-blue-500 text-white px-2 rounded">+</button>' +
          '</div>';

        container.appendChild(div);

        // attach handlers
        const minus = div.querySelector('.minus');
        const plus = div.querySelector('.plus');
        const qtyEl = div.querySelector('.quantity');

        minus.addEventListener('click', () => {
          let q = parseInt(qtyEl.textContent, 10);
          if (q > 0) {
            q--;
            qtyEl.textContent = q;
            updateTotal();
          }
        });

        plus.addEventListener('click', () => {
          let q = parseInt(qtyEl.textContent, 10);
          if (q < ticket.max) {
            q++;
            qtyEl.textContent = q;
            updateTotal();
          }
        });
      });

      // calculate total and build selectedTickets array
      function updateTotal() {
        total = 0;
        selectedTickets = [];
        const cards = document.querySelectorAll('.ticket-item');
        cards.forEach((card, idx) => {
          const qty = Number(card.querySelector('.quantity').textContent) || 0;
          if (qty > 0) {
            const t = ticketsData[idx];
            selectedTickets.push({ name: t.name, price: t.price, quantity: qty });
            total += t.price * qty;
          }
        });
        totalSpan.textContent = 'â‚¬' + total.toFixed(2);
        // debug log (open console to verify)
        console.debug('selectedTickets', selectedTickets);
      }

      // proceed: save and redirect
      proceedBtn.addEventListener('click', () => {
        if (selectedTickets.length === 0) {
          alert('Please select at least one ticket before proceeding.');
          return;
        }
        // save in localStorage
        try {
          localStorage.setItem('selectedTickets', JSON.stringify(selectedTickets));
          localStorage.setItem('selectedTotal', total.toFixed(2));
        } catch (e) {
          console.error('Could not write selected tickets to localStorage', e);
        }
        window.location.href = 'payment.html';
      });

      // init total (in case values were prefilled)
      updateTotal();
    });
  </script>
</body>
</html>